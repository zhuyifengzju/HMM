A = [0.5, 0.2, 0.3;...
     0.3, 0.5, 0.2;...
     0.2, 0.3, 0.5]; % NxN

 B = [0.5, 0.5; 0.4, 0.6; 0.7, 0.3]; % NxM
 M = 2; %观测状态数
 p = [0.2,0.4,0.4]';
 N = 3;
 T = 3;
 O = [1,2,1];
 
 beta = ones(1,N);
 for i = T-1:-1:1
     beta = A * (B(:,O(i+1)).*(beta)');
     beta = beta';
 end;
 
 p' * (B(:,O(1)).*beta')